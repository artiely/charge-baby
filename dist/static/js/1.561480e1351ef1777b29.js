webpackJsonp([1],{"5zde":function(t,e,a){a("zQR9"),a("qyJz"),t.exports=a("FeBl").Array.from},Gu7T:function(t,e,a){"use strict";e.__esModule=!0;var r,n=a("c/Tr"),i=(r=n)&&r.__esModule?r:{default:r};e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,i.default)(t)}},YsH8:function(t,e){},"c/Tr":function(t,e,a){t.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(t,e,a){"use strict";var r=a("evD5"),n=a("X8DO");t.exports=function(t,e,a){e in t?r.f(t,e,n(0,a)):t[e]=a}},l5Ru:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),i=a("Gu7T"),o=a.n(i),s=a("Xxa5"),c=a.n(s),l=a("exGp"),d=a.n(l),u=a("H8JJ"),p=a("c9Np"),_=[{title:"设备id",key:"code",dataIndex:"code",scopedSlots:{customRender:"code"},width:150,fixed:"left"},{key:"created_at",title:"入住时间",dataIndex:"created_at",width:150},{key:"type.name",title:"设备类型",dataIndex:"type.name",width:150},{key:"box_status_cn",title:"运行状态",dataIndex:"box_status_cn[0]",scopedSlots:{customRender:"box_status_cn"},width:100},{key:"status",title:"机柜状态",dataIndex:"status",scopedSlots:{customRender:"status"},width:100},{key:"unit_price",title:"单价/小时(元)",dataIndex:"unit_price",width:100},{key:"upper_price",title:"24h最高收费(元)",dataIndex:"upper_price",width:150},{key:"store.name",title:"所属商户",dataIndex:"store.name",width:150},{key:"qrcode",title:"二维码",dataIndex:"qrcode",scopedSlots:{customRender:"qrcode"},width:150},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},width:200,fixed:"right"}],f={mixins:[u.a],components:{recordList:p.default},data:function(){return{columns:_,boxtype:null,status:!0,infoVisible:!1,recordVisible:!1,chargeItems:[],labelCol:{span:7},wrapperCol:{span:17}}},watch:{row:{handler:function(t){t&&(this.status=1===t.status)},deep:!0}},methods:{fetch:function(){return"BOX_LIST"},info:function(t){var e=this;return d()(c.a.mark(function a(){var r;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.infoVisible=!0,a.next=3,e.$api.CHARGE_LIST({page:1,limit:50,box_id:t.id});case 3:r=a.sent,e.chargeItems=r.data;case 5:case"end":return a.stop()}},a,e)}))()},pop:function(t){var e=this;return d()(c.a.mark(function a(){return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$api.CHARGE_POP({box_id:t.box_id,pipe:t.pipe});case 2:"success"===a.sent.msg&&e.$message.success("弹出成功");case 4:case"end":return a.stop()}},a,e)}))()},getQrcode:function(t){var e=this;return d()(c.a.mark(function a(){var r,n,i;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$api.BOX_QRCODE({code:t.code});case 2:r=a.sent,n=[].concat(o()(e.data)),(i=n.filter(function(e){return t.key===e.key})[0])&&(i.qrcode=r.url,e.data=n);case 6:case"end":return a.stop()}},a,e)}))()},editFetch:function(){return"BOX_PUT_POST"},boxtypeList:function(){var t=this;return d()(c.a.mark(function e(){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.BOXTYPE_LIST({page:1,limit:100});case 2:a=e.sent,t.boxtype=a.data;case 4:case"end":return e.stop()}},e,t)}))()},handleSubmit:function(){var t=this;this.form.validateFields(function(e,a){var r=n()({id:t.row.id},a,{status:t.status?1:0});e||t.save(r)})},history:function(t){this.row=t,this.recordVisible=!0}},created:function(){this.boxtypeList()}},v={render:function(){var t=this,e=this,a=e.$createElement,r=e._self._c||a;return r("div",[r("a-card",[r("div",{attrs:{slot:"title"},slot:"title"},[r("a-input-search",{staticStyle:{width:"400px"},attrs:{placeholder:"商户名/设备类型"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),r("a-range-picker",{staticClass:"pull-right",attrs:{format:"YYYY-MM-DD"},on:{change:e.timeChange}})],1),e._v(" "),r("a-table",{attrs:{columns:e.columns,size:"middle",dataSource:e.data,pagination:!1,loading:e.loading,scroll:{x:1400}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"created_at",fn:function(t,a){return[r("a",{attrs:{href:"#"}},[e._v(e._s(a.mobile)+" - "+e._s(a.name))])]}},{key:"status",fn:function(t,a){return[1==t?r("a-tag",{attrs:{color:"#87d068"}},[e._v("启用")]):e._e(),e._v(" "),0==t?r("a-tag",{attrs:{color:"#f50"}},[e._v("停用")]):e._e()]}},{key:"box_status_cn",fn:function(t,a){return e._l(a.box_status_cn,function(t,a){return r("span",{key:a},["正常"==t?r("a-tag",{attrs:{color:"green"}},[e._v("正常")]):e._e(),e._v(" "),"机柜已空"==t?r("a-tag",{attrs:{color:"pink"}},[e._v("机柜已空")]):e._e(),e._v(" "),"充电宝弹出卡死"==t?r("a-tag",{attrs:{color:"pink"}},[e._v("充电宝弹出卡死")]):e._e(),e._v(" "),"充电宝电量低于标准值"==t?r("a-tag",{attrs:{color:"orange"}},[e._v("充电宝电量低于标准值")]):e._e(),e._v(" "),"充电宝损坏"==t?r("a-tag",{attrs:{color:"green"}},[e._v("充电宝损坏")]):e._e(),e._v(" "),"充电宝丢失"==t?r("a-tag",{attrs:{color:"cyan"}},[e._v("充电宝丢失")]):e._e(),e._v(" "),"系统复位"==t?r("a-tag",{attrs:{color:"blue"}},[e._v("系统复位")]):e._e(),e._v(" "),"新插入充电宝"==t?r("a-tag",{attrs:{color:"purple"}},[e._v("新插入充电宝")]):e._e()],1)})}},{key:"qrcode",fn:function(t,a){return[r("span",[r("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.getQrcode(a)}}},[r("a-icon",{attrs:{type:"qrcode"}}),e._v(" 点击生成\n          ")],1),e._v(" "),a.qrcode?r("a",{attrs:{href:a.qrcode,download:a.code,target:"_block"}},[e._v("\n            查看\n            "),r("img",{staticStyle:{display:"none"},attrs:{src:a.qrcode,download:a.code}})]):e._e()])]}},{key:"operation",fn:function(t,a){return[r("a",{on:{click:function(t){e.history(a)}}},[e._v("使用记录")]),e._v(" "),r("a-divider",{attrs:{type:"vertical"}}),e._v(" "),r("a",{on:{click:function(t){e.edit(a)}}},[e._v("编辑")]),e._v(" "),r("a-divider",{attrs:{type:"vertical"}}),e._v(" "),r("a",{on:{click:function(t){e.info(a)}}},[e._v("详情")])]}}])}),e._v(" "),e.last_page>1?r("a-pagination",{staticStyle:{"margin-top":"6px"},attrs:{defaultCurrent:1,total:e.total},on:{change:e.onChange}}):e._e()],1),e._v(" "),r("a-modal",{attrs:{title:e.title,footer:null},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("a-form",{attrs:{autoFormCreate:function(e){t.form=e}},on:{submit:e.handleSubmit}},[r("a-form-item",{attrs:{required:"",label:"设备类型",labelCol:e.labelCol,wrapperCol:e.wrapperCol,fieldDecoratorId:"type_id",fieldDecoratorOptions:{initialValue:e.row.type_id}}},[r("a-select",e._l(e.boxtype,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),e._v(" "),r("a-form-item",{attrs:{label:"单价/小时(元)",labelCol:e.labelCol,wrapperCol:e.wrapperCol,fieldDecoratorId:"unit_price",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入商户密码"}],initialValue:e.row.unit_price}}},[r("a-input",{attrs:{type:"number"}})],1),e._v(" "),r("a-form-item",{attrs:{required:"",label:"24h最高收费(元)",labelCol:e.labelCol,wrapperCol:e.wrapperCol,fieldDecoratorId:"upper_price",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入商户地址"}],initialValue:e.row.upper_price}}},[r("a-input",{attrs:{type:"number"}})],1),e._v(" "),r("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"机柜状态",fieldDecoratorId:"status"}},[r("a-switch",{attrs:{checkedChildren:"已启用",unCheckedChildren:"已停用"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}})],1),e._v(" "),r("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[r("a-button",{staticStyle:{width:"120px","margin-right":"10px"},attrs:{type:"dashed",size:"large"},on:{click:function(t){e.visible=!1}}},[e._v("\n          取消\n        ")]),e._v(" "),r("a-button",{staticStyle:{width:"120px"},attrs:{type:"primary",htmlType:"submit",size:"large"}},[e._v("\n          保存\n        ")])],1)],1)],1),e._v(" "),r("a-modal",{attrs:{width:600},on:{ok:function(t){e.infoVisible=!1}},model:{value:e.infoVisible,callback:function(t){e.infoVisible=t},expression:"infoVisible"}},[r("div",{attrs:{slot:"title"},slot:"title"},[e._v("机柜详情\n      "),e.chargeItems[0]&&e.chargeItems[0].box?r("a",[e._v(" "+e._s(e.chargeItems[0].box.code))]):e._e()]),e._v(" "),e.chargeItems.length>0?r("div",[e._l(e.chargeItems,function(t){return r("span",{key:t.id,staticStyle:{display:"inline-block",width:"120px"}},[r("a-popconfirm",{attrs:{trigger:"click"},on:{confirm:function(a){e.pop(t)}}},[r("div",{attrs:{slot:"title"},slot:"title"},[r("div",[e._v("确定强制弹出该充电宝吗？")]),e._v(" "),r("div",[e._v("强制弹出的充电宝不会加入订单")])]),e._v(" "),"充电"==t.status_cn?r("a-tag",{staticClass:"charge-item",attrs:{color:"blue"}},[e._v(e._s(t.id)+".充电 "+e._s(t.power)+"%")]):e._e()],1),e._v(" "),"启用"==t.status_cn?r("a-tag",{staticClass:"charge-item",attrs:{color:"green"}},[e._v(e._s(t.id)+".启用 "+e._s(t.power)+"%")]):e._e(),e._v(" "),"使用"==t.status_cn?r("a-tag",{staticClass:"charge-item",attrs:{color:"cyan"}},[e._v(e._s(t.id)+".使用 "+e._s(t.power)+"%")]):e._e()],1)}),e._v(" "),r("a-alert",{staticStyle:{"margin-top":"20px"},attrs:{message:"点击正在充电的充电宝可以强制弹出",banner:""}})],2):r("div",[r("a-icon",{attrs:{type:"meh-o"}}),e._v(" 暂无相关数据\n    ")],1)]),e._v(" "),r("canvas",{attrs:{id:"canvas"}}),e._v(" "),r("record-list",{attrs:{boxId:e.row.id},model:{value:e.recordVisible,callback:function(t){e.recordVisible=t},expression:"recordVisible"}})],1)},staticRenderFns:[]};var h=a("VU/8")(f,v,!1,function(t){a("YsH8")},null,null);e.default=h.exports},qyJz:function(t,e,a){"use strict";var r=a("+ZMJ"),n=a("kM2E"),i=a("sB3e"),o=a("msXi"),s=a("Mhyx"),c=a("QRG4"),l=a("fBQ2"),d=a("3fs2");n(n.S+n.F*!a("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,n,u,p=i(t),_="function"==typeof this?this:Array,f=arguments.length,v=f>1?arguments[1]:void 0,h=void 0!==v,m=0,b=d(p);if(h&&(v=r(v,f>2?arguments[2]:void 0,2)),void 0==b||_==Array&&s(b))for(a=new _(e=c(p.length));e>m;m++)l(a,m,h?v(p[m],m):p[m]);else for(u=b.call(p),a=new _;!(n=u.next()).done;m++)l(a,m,h?o(u,v,[n.value,m],!0):n.value);return a.length=m,a}})}});
//# sourceMappingURL=1.561480e1351ef1777b29.js.map